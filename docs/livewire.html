<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Lychee Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <link rel="canonical" href="https://lycheeorg.github.io/docs/">

    <!-- Favicon -->
    <!-- <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png"> -->
    <link rel="icon" type="image/png" href="/assets/images/logo.png">
    <!-- <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png"> -->
    <!-- <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png"> -->
    <!-- <link rel="manifest" href="/img/favicon/site.webmanifest"> -->
    <!-- <link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#ff2d20"> -->
    <!-- <link rel="shortcut icon" href="/img/favicon/favicon.ico"> -->
    <meta name="msapplication-TileColor" content="#ff2d20">
    <!-- <meta name="msapplication-config" content="/img/favicon/browserconfig.xml"> -->
    <meta name="theme-color" content="#ffffff">

    <!-- Load styles -->
    <link rel="stylesheet" type="text/css" href="css/app.css">
    <link rel="stylesheet" type="text/css" href="css/prism.css">

    <!-- Load JS -->
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/prism.js"></script>

</head>

<body>

    <div class="sidebar_layout" id="docsScreen">

        <div class="page_contain">
            <div class="contain">
                <aside class="sidebar">
                    <a href="../" class="logo">
                        <img class="mark" src="/assets/images/logo.png" alt="Laravel">
                        <img class="type" src="img/Lychee.png" alt="Laravel">
                    </a>
                    <nav>
                        <div class="navigation_contain">
                            <div class="docs_sidebar">
                                <ul>
                                    <li class='sub--on'>
<h2>Prologue</h2>
<ul>
<li><a href='org.html'>Lychee & LycheeOrg</a></li>
<li><a href='releases.html'>Release Notes</a></li>
</ul>
<li class='sub--on'>
<h2>Getting Started</h2>
<ul>
<li><a href='installation.html'>Installation</a></li>
<li><a href='configuration.html'>Configuration</a></li>
<li><a href='docker.html'>Docker</a></li>
<li><a href='update.html'>Update</a></li>
<li><a href='upgrade.html'>Upgrade from v3</a></li>
</ul>
<li class='sub--on'>
<h2>Advanced Topics</h2>
<ul>
<li><a href='settings.html'>Settings</a></li>
<li><a href='keyboard.html'>Keyboard Shortcuts</a></li>
<li><a href='advanced-setups.html'>Advanced Setups</a></li>
<li><a href='honeypot.html'>Honeypot and Teapots</a></li>
<li><a href='external_tracking.html'>External tracking with Matomo, Google Analytics & Co</a></li>
</ul>
<li class='sub--on'>
<h2>Frequently Asked Question</h2>
<ul>
<li><a href='faq_general.html'>General</a></li>
<li><a href='faq_installation.html'>Installation, migration, upgrade, update</a></li>
<li><a href='faq_troubleshooting.html'>Troubleshooting</a></li>
</ul>
<li class='sub--on'>
<h2>Contributing</h2>
<ul>
<li><a href='contributions.html'>Contribution Guide</a></li>
<li><a href='api.html'>API Documentation</a></li>
<li><a href='architecture.html'>Lychee logic overview</a></li>
<li><a href='structure.html'>Directory Structure</a></li>
<li><a href='frontend.html'>Front-end</a></li>
<li class='active'><a href='livewire.html'>Livewire Front-end (alpha)</a></li>
</ul>

                                    <li class="laravel">
                                        <a href="https://laravel.com/docs/8.x"><h2>Laravel<img style="margin-left:4px;" src="img/external-link.svg" /></h2></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </nav>
                    <div class="trigger_contain">
                        <a href="#" class="nav_trigger" aria-label="Menu">
                            <div class="bar"></div>
                        </a>
                    </div>
                </aside>

                <section class="body_content">
                    <section class="docs_body">
                        <section class="docs_main">
                            <h1>Livewire Front-end (alpha)</h1>
                            
<ul>
<li><a href="#a-brief-introduction-to-livewire">A brief introduction to Livewire</a><ul>
<li><a href="#livewire-and-controllers">Livewire and Controllers</a></li>
<li><a href="#laravel-components">Laravel Components</a></li>
<li><a href="#livewire-components">Livewire Components</a></li>
</ul>
</li>
<li><a href="#lychee-livewire-front-end">Lychee Livewire Front-end</a></li>
<li><a href="#pitfalls-wireable">Pitfalls &amp; Wireable</a></li>
</ul>

                            <hr> <h2 id="a-brief-introduction-to-livewire"><a class="toclink" href="#a-brief-introduction-to-livewire">A brief introduction to Livewire</a></h2>
<p>We first give a short intuition of how Livewire, the framework of the new front-end, works.</p>
<h3 id="livewire-and-controllers"><a class="toclink" href="#livewire-and-controllers">Livewire and Controllers</a></h3>
<p>The Laravel framework on which Lychee is based provides two options regarding how a request may be routed:</p>
<ul>
<li>the request is directed to a controller below <code>app/Http/Controllers</code></li>
<li>the request is directed to a Livewire component below <code>app/Http/Livewire</code></li>
</ul>
<p>In the first case, a controller returns a JSON object or an HTML page rendered from a blade template.
In the second case (Livewire), only a block of HTML built from a blade template will be returned.</p>
<p>From a very high level, Livewire makes use of two folders:</p>
<ul>
<li><code>app/Http/Livewire</code> which hosts the components and their inner logic.</li>
<li><code>resources/views/components</code> which hosts the HTML layout of the components.</li>
</ul>
<p>So far one could say there is not much difference with a normal request life cycle. Where Livewire starts to shine is in the ability to call the methods of the component directly <em>from HTML</em>. Instead of having to use a JavaScript hook, make an AJAX call, parse the result, and update the layout accordingly, the user/programmer can directly interact with the designated component and Livewire takes care of the request and rendering.</p>
<h3 id="laravel-components"><a class="toclink" href="#laravel-components">Laravel Components</a></h3>
<p>In Laravel, it is possible to create reusable templates also called components. They are called from the blade part using the following syntax:</p>
<pre><code class="language-html">&lt;x-album :data=&quot;$album&quot; /&gt;
</code></pre>
<p>Note that PHP expressions and variables should be passed to the component via attributes that use the <code>:</code> character as a prefix (in this case <code>data</code>).
Attributes are automatically inserted in the constructor of the component:</p>
<pre><code class="language-php">public function __construct(AbstractAlbum $data)
{
    // component logic for the rendering
}
</code></pre>
<p>Laravel then calls the <code>render()</code> method and returns the corresponding view.</p>
<pre><code class="language-php">public function render()
{
    return view('components.molecules.album');
}

</code></pre>
<p>Public attributes in the component class (e.g. <code>public string $title</code>) are then accessible in the blade template part:</p>
<pre><code class="language-html">&lt;!--  ...  --&gt;
&lt;div class='overlay'&gt;
    &lt;h1 title='{{ $title }}'&gt;{{ $title }}&lt;/h1&gt;
&lt;/div&gt;
&lt;!--  ...  --&gt;
</code></pre>
<h3 id="livewire-components"><a class="toclink" href="#livewire-components">Livewire Components</a></h3>
<p>Similarly to Laravel components, the Livewire ones use the <code>render()</code> method, blade views, and public attributes.
One could say that the Livewire components are just Laravel components on steroids.</p>
<p>In order to call Livewire, the following syntax is used:</p>
<pre><code class="language-html">&lt;livewire:sidebar.album :album=&quot;$this-&gt;album&quot; /&gt;
</code></pre>
<p>This will call the Livewire component located at <code>app/Http/Livewire/Sidebar/Album.php</code>.<br />
As opposed to their Laravel counterparts, it is not possible to use the constructor to read the attributes.
For this reason a method <code>mount()</code> has been added:</p>
<pre><code class="language-php">public function mount(AbstractAlbum $album)
{
    $this-&gt;load($album);
}
</code></pre>
<p>Then the <code>render()</code> function is used in order to retrieve the respective HTML section of the component.</p>
<pre><code class="language-php">public function render()
{
    return view('livewire.sidebar.album');
}
</code></pre>
<h4 id="calling-methods"><a class="toclink" href="#calling-methods">Calling methods</a></h4>
<p>Where Livewire becomes interesting is in its ability to call PHP functions directly from user-land.
Methods of the component can be callable by using additional HTML attributes.
For example in <code>resources/views/livewire/components/modules/album.php</code> the attribute <code>wire:click="login"</code>
will call the <code>login()</code> method of the component <code>app/Http/Livewire/Header.php</code></p>
<pre><code class="language-html">&lt;a wire:click=&quot;login&quot; class=&quot;button&quot;&gt;
    &lt;x-icons.iconic icon='account-login' /&gt;
&lt;/a&gt;
</code></pre>
<pre><code class="language-php">public function login()
{
    // ...
}
</code></pre>
<p>This method will then execute and trigger a re-rendering of the component.</p>
<h4 id="emitting-events"><a class="toclink" href="#emitting-events">Emitting events</a></h4>
<p>In addition to calling a method of a component,
it is also possible to trigger actions in other components.
As a matter of fact, in the specific case of the <code>login()</code> method,
we are emitting an event which will trigger the opening of the <code>app/Http/Livewire/Components/Modal.php</code> component with a login form:</p>
<pre><code class="language-php">protected function login()
{
    $form = 'forms.login';
    $params = [];
    $this-&gt;emitTo('components.modal', 'openModal', $form, $params);
}
</code></pre>
<p><code>Modal.php</code> contains the following code:</p>
<pre><code class="language-php">class Modal extends Openable
{
    protected $listeners = [
        'openModal',
        // ...
    ];

    public function openModal(string $type, array $params = [])
    {
        //...
    }
</code></pre>
<p>The protected variable <code>$listeners</code> informs the component which events it needs to react to.
In this specific case <code>openModal()</code> method has two arguments which are provided by the <code>$this-&gt;emitTo('componentName', 'eventName', $arg1, $arg2);</code></p>
<p>With these tools at hand, we are now able to understand a bit better the structure of the Livewire front-end.</p>
<h2 id="lychee-livewire-front-end"><a class="toclink" href="#lychee-livewire-front-end">Lychee Livewire Front-end</a></h2>
<p>A high-level view is presented in the following picture (at the time of writing, open full image for better view).</p>
<!-- [![](img/Livewire Class Diagram.jpg)](img/Livewire Class Diagram.jpg) -->
<p><a href="img/Livewire-component-diagram.png"><img alt="" src="img/Livewire-component-diagram.png" /></a></p>
<p>For now the entry point is always <code>app/Http/Livewire/Pages/Fullpage.php</code>.
The path of the code is the following:</p>
<ol>
<li>Calls <code>app/Http/Livewire/Pages/Fullpage.php</code></li>
<li>Loads:<ul>
<li>the <code>Top</code> level,</li>
<li>or the requested <code>Album</code> and children,</li>
<li>or the requested <code>Album</code> and requested <code>Photo</code></li>
</ul>
</li>
<li>Renders <code>resources/views/livewire/pages/fullpage.blade.php</code></li>
<li>Calls:<ul>
<li><code>app/Http/Livewire/Component/Header.php</code></li>
<li>and one of the <code>$module</code><ul>
<li><code>app/Http/Livewire/Modules/Albums.php</code>  </li>
<li>or <code>app/Http/Livewire/Modules/Album.php</code><br />
and <code>app/Http/Livewire/Components/Sidebar.php</code></li>
<li>or <code>app/Http/Livewire/Modules/Photo.php</code><br />
and <code>app/Http/Livewire/Components/Sidebar.php</code></li>
</ul>
</li>
</ul>
</li>
<li>Renders <code>resources/views/livewire/components/header.blade.php</code>
    and calls the header layout corresponding to the current module selected:<ul>
<li><code>resources/views/livewire/components/modules/albums.php</code></li>
<li>or <code>resources/views/livewire/components/modules/album.php</code></li>
<li>or <code>resources/views/livewire/components/modules/photo.php</code></li>
</ul>
</li>
<li>Renders the module selected; in the case of 
    <code>app/Http/Livewire/Modules/Photo.php</code> we also call the
    <code>app/Http/Livewire/Components/PhotoOverlay.php</code></li>
<li>Renders the sidebar <code>app/Http/Livewire/Components/Sidebar.php</code>
    which calls:<ul>
<li><code>app/Http/Livewire/Sidebar/Album.php</code></li>
<li>or <code>app/Http/Livewire/Sidebar/Photo.php</code></li>
</ul>
</li>
<li>At this point, you pretty much have the full picture...</li>
</ol>
<p>In summary:</p>
<ol>
<li>Load FullPage</li>
<li>Load Header</li>
<li>Load Module</li>
<li>Load Sidebar</li>
</ol>
<p>Each step is basically bouncing between the PHP and the blade part.</p>
<h2 id="pitfalls-wireable"><a class="toclink" href="#pitfalls-wireable">Pitfalls &amp; Wireable</a></h2>
<p>There are a few points where special attention is required. At the end of lifecycle of a request,
Livewire deserializes the components and forwards them to the client in an encrypted and hashed form.
When executing a method call from user-land, component's data are sent to the server and deserialized.
If an attribute of the component is an <code>Interface</code>, Livewire will panic. It uses the type of the attribute
to retrieve the constructor and hydrate the model.</p>
<p>Do note that by default, the dehydration uses the <code>toArray()</code> method. As a result the hydration will not be working in most cases.
For this reason Livewire proposes the interface <code>Wireable</code> which requires two methods: <code>toLivewire()</code> and <code>static fromLivewire($value)</code>.
The former will return the serialized version of the object and the latter will rebuild the object from the serialized version.</p><blockquote><p>{tip} Caught a mistake or want to contribute to the documentation?&nbsp;<a href="https://github.com/LycheeOrg/LycheeOrg.github.io/tree/master/docs/livewire.md">Edit this page on Github!</a></p></blockquote>
                        </section>
                    </section>
                </section>
            </div>
        </div>

    </div>
</body>
<script src="js/app.js"></script>

</html>
